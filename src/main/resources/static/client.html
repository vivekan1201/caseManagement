<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="">
    <meta name="author" content="">

    <title>Mini Finance - Wallet Page</title>

    <!-- CSS FILES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;700&display=swap" rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/bootstrap-icons.css" rel="stylesheet">

    <link href="css/apexcharts.css" rel="stylesheet">

    <link href="css/tooplate-mini-finance.css" rel="stylesheet">

    <link href="css/style.css" rel="stylesheet">
    <link href="css/filter.css" rel="stylesheet">

    <!--

    Tooplate 2135 Mini Finance

    https://www.tooplate.com/view/2135-mini-finance

    Bootstrap 5 Dashboard Admin Template

    -->
</head>

<body>
<header class="navbar sticky-top flex-md-nowrap">
    <div class="col-md-3 col-lg-3 me-0 px-3 fs-6">
        <a class="navbar-brand" href="index.html">
            <i class="bi-box"></i>
            Mini Finance
        </a>
    </div>

    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <form class="custom-form header-form ms-lg-3 ms-md-3 me-lg-auto me-md-auto order-2 order-lg-0 order-md-0" action="#" method="get" role="form">
        <input class="form-control" name="search" type="text" placeholder="Search" aria-label="Search">
    </form>

    <div class="navbar-nav me-lg-2">
        <div class="nav-item text-nowrap d-flex align-items-center">
            <div class="dropdown ps-3">
                <a class="nav-link dropdown-toggle text-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi-bell"></i>
                    <span class="position-absolute start-100 translate-middle p-1 bg-danger border border-light rounded-circle">
                                <span class="visually-hidden">New alerts</span>
                            </span>
                </a>

                <ul class="dropdown-menu notifications-block-wrap bg-white shadow">
                    <small>Notifications</small>

                    <li class="notifications-block border-bottom pb-2 mb-2">
                        <a class="dropdown-item d-flex align-items-center" href="#">
                            <div class="notifications-icon-wrap bg-success">
                                <i class="notifications-icon bi-check-circle-fill"></i>
                            </div>

                            <div>
                                <span>Your account has been created successfuly.</span>

                                <p>12 days ago</p>
                            </div>
                        </a>
                    </li>

                    <li class="notifications-block border-bottom pb-2 mb-2">
                        <a class="dropdown-item d-flex align-items-center" href="#">
                            <div class="notifications-icon-wrap bg-info">
                                <i class="notifications-icon bi-folder"></i>
                            </div>

                            <div>
                                <span>Please check. We have sent a Daily report.</span>

                                <p>10 days ago</p>
                            </div>
                        </a>
                    </li>

                    <li class="notifications-block">
                        <a class="dropdown-item d-flex align-items-center" href="#">
                            <div class="notifications-icon-wrap bg-danger">
                                <i class="notifications-icon bi-question-circle"></i>
                            </div>

                            <div>
                                <span>Account verification failed.</span>

                                <p>1 hour ago</p>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="dropdown ps-1">
                <a class="nav-link dropdown-toggle text-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi-three-dots-vertical"></i>
                </a>

                <div class="dropdown-menu dropdown-menu-social bg-white shadow">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/search.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Google</span>
                                </a>
                            </div>

                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/spotify.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Spotify</span>
                                </a>
                            </div>

                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/telegram.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Telegram</span>
                                </a>
                            </div>

                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/snapchat.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Snapchat</span>
                                </a>
                            </div>

                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/tiktok.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Tiktok</span>
                                </a>
                            </div>

                            <div class="col-lg-4 col-md-4 col-4">
                                <a class="dropdown-item text-center" href="#">
                                    <img src="images/social/youtube.png" class="profile-image img-fluid" alt="">
                                    <span class="d-block">Youtube</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="dropdown px-3">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <img src="images/medium-shot-happy-man-smiling.jpg" class="profile-image img-fluid" alt="">
                </a>
                <ul class="dropdown-menu bg-white shadow">
                    <li>
                        <div class="dropdown-menu-profile-thumb d-flex">
                            <img src="images/medium-shot-happy-man-smiling.jpg" class="profile-image img-fluid me-3" alt="">

                            <div class="d-flex flex-column">
                                <small>Thomas</small>
                                <a href="#">thomas@site.com</a>
                            </div>
                        </div>
                    </li>

                    <li>
                        <a class="dropdown-item" href="profile.html">
                            <i class="bi-person me-2"></i>
                            Profile
                        </a>
                    </li>

                    <li>
                        <a class="dropdown-item" href="setting.html">
                            <i class="bi-gear me-2"></i>
                            Settings
                        </a>
                    </li>

                    <li>
                        <a class="dropdown-item" href="help-center.html">
                            <i class="bi-question-circle me-2"></i>
                            Help
                        </a>
                    </li>

                    <li class="border-top mt-3 pt-2 mx-4">
                        <a class="dropdown-item ms-0 me-0" href="#">
                            <i class="bi-box-arrow-left me-2"></i>
                            Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-3 d-md-block sidebar collapse">
            <div class="position-sticky py-4 px-3 sidebar-sticky">
                <ul class="nav flex-column h-100">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="dashboardtrial.html">
                            <i class="bi-house-fill me-2"></i>
                            Overview
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="Page1.html">
                            <i class="bi-wallet me-2"></i>
                            Calendar
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active" href="addclient.html">
                            <i class="bi-wallet me-2"></i>
                            Add Client
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link active" href="client.html">
                            <i class="bi-wallet me-2"></i>
                            My Clients
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="addservice.html">
                            <i class="bi-house-fill me-2"></i>
                            Modify Service
                        </a>
                    </li>
                    <li class="nav-item border-top mt-auto pt-2">
                        <a class="nav-link" href="#">

                            <img src="girlsitting.svg" alt="Header Image" class="header-image" style="width: 400px; height: auto;">

                        </a>
                    </li>
                    <li class="nav-item border-top mt-auto pt-2">
                        <a class="nav-link" href="#">
                            <i class="bi-box-arrow-left me-2"></i>
                            Logout
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <main class="main-wrapper col-md-9 ms-sm-auto py-4 col-lg-9 px-md-4 border-start">
            <div class="title-group mb-3">
                <h1 class="h2 mb-0">My Clients</h1>
            </div>

            <div class="row my-4">
                <div class="col-lg-12 col-12">
                    <nav>
                        <ul class="dropdown">
                            <li class="drop"><a href="">Service</a>
                                <ul class="sub_menu">
<!--                                    Dynamic Services here-->
                                    <li><a href="#">All Services</a></li>
                                </ul>
                            </li>
                            <li class="drop" id="startDateDropdown">
                                <a href="#">Start Date</a>
                                <ul class="sub_menu" id="startDateMenu">
                                    <!-- Existing options can be here -->
                                    <li><a href="#">All Dates</a></li>  <!-- New All Dates option -->
                                    <!-- You can add other date options here as needed -->
                                </ul>
                            </li>
                            <li class="drop"><a href="#">Region</a>
                                <ul class="sub_menu">
<!--                                   Dynamic regions here-->
                                    <li><a href="#">All Regions</a></li>
                                </ul>
                            </li>
                        </ul>
                        <button type="submit" id="filter-button" class="btn btn-lg btn-primary" style="margin-left: 3%; margin-top: 1%;">Filter</button>

                    </nav>
                </div>
            </div>

            <div class="row my-4">
                <div class="col-lg-12 col-12">
                    <div class="custom-block bg-white">
                        <h5 class="mb-4">Client Details</h5>

                        <div class="table-responsive">
                            <table class="account-table table">
                                <thead>
                                <tr>
                                    <th scope="col">Name</th>
                                    <th scope="col">Email</th>
                                    <th scope="col">Service</th>
                                    <th scope="col">Address</th>
                                    <th scope="col">Action</th>
                                </tr>
                                </thead>
                                <tbody id="client-table-body">
                                <!-- Dynamic rows will be inserted here -->
                                </tbody>
                            </table>
                        </div>

                        <!-- Popup Overlay -->
                        <div class="popup-overlay" style="display: none;">
                            <div class="popup-content">
                                <div class="popup-header">
                                    <h5>Client Details</h5>
                                    <button class="popup-close">&times;</button>
                                </div>
                                <div id="popup-body">
                                    <!-- Dynamic popup content will be inserted here -->
                                </div>
                            </div>
                        </div>

                        <nav aria-label="Page navigation example">
                            <ul class="pagination justify-content-center mb-0">
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Previous">
                                        <span aria-hidden="true">Prev</span>
                                    </a>
                                </li>

                                <li class="page-item active" aria-current="page">
                                    <a class="page-link" href="#">1</a>
                                </li>

                                <li class="page-item">
                                    <a class="page-link" href="#">2</a>
                                </li>

                                <li class="page-item">
                                    <a class="page-link" href="#">3</a>
                                </li>

                                <li class="page-item">
                                    <a class="page-link" href="#">4</a>
                                </li>

                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Next">
                                        <span aria-hidden="true">Next</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
            <footer class="site-footer">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-12 col-12">
                            <p class="copyright-text">Copyright © Insights

                        </div>

                    </div>
                </div>
            </footer>

        </main>

    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const popupOverlay = document.querySelector(".popup-overlay");
        const viewAllButtons = document.querySelectorAll(".view-all-btn");
        const closePopup = document.querySelector(".popup-close");
        const popupBody = document.getElementById("popup-body");

        // Show popup and populate details
        viewAllButtons.forEach(button => {
            button.addEventListener("click", (e) => {
                const row = e.target.closest("tr");
                const name = row.cells[0].textContent;
                const email = row.cells[1].textContent;
                const phone = row.cells[2].textContent;
                const address = row.cells[3].textContent;

                // Set the popup content
                popupBody.innerHTML = `
                    <p><strong>Name:</strong> ${name}</p>
                    <p><strong>Email:</strong> ${email}</p>
                    <p><strong>Phone:</strong> ${phone}</p>
                    <p><strong>Address:</strong> ${address}</p>
                `;

                // Show the popup
                popupOverlay.style.display = "flex";
            });
        });

        // Close popup
        closePopup.addEventListener("click", () => {
            popupOverlay.style.display = "none";
        });

        // Close popup when clicking outside
        popupOverlay.addEventListener("click", (e) => {
            if (e.target === popupOverlay) {
                popupOverlay.style.display = "none";
            }
        });
    });
</script>

<!-- JAVASCRIPT FILES -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/apexcharts.min.js"></script>
<script src="js/custom.js"></script>
<script src="js/filter.js"></script>


<script>
    // Fetch data from the API and populate the table
    fetch('http://localhost:8080/api/myclients?staff=Sarah')
        .then(response => response.json())
        .then(clients => {
            const tableBody = document.getElementById('client-table-body');
            clients.forEach(client => {
                const fullName = `${client.firstName} ${client.lastName}`;
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${fullName}</td>
                    <td>${client.email}</td>
                    <td>${client.service}</td>
                    <td>${client.address}</td>
                    <td>
                        <button class="btn btn-primary btn-sm view-all-btn" data-client-id="${client.id}">View All</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });

            // Add event listeners for "View All" buttons
            const viewAllButtons = document.querySelectorAll('.view-all-btn');
            viewAllButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const clientId = button.getAttribute('data-client-id');
                    const client = clients.find(client => client.id === clientId);
                    showPopup(client);
                });
            });
        })
        .catch(error => {
            console.error('Error fetching clients:', error);
        });

    // Show the popup with the full client details
    function showPopup(client) {
        const popupOverlay = document.querySelector('.popup-overlay');
        const popupBody = document.getElementById('popup-body');
        popupBody.innerHTML = `
            <p><strong>Full Name:</strong> ${client.firstName} ${client.lastName}</p>
            <p><strong>Email:</strong> ${client.email}</p>
            <p><strong>Phone:</strong> ${client.phone}</p>
            <p><strong>Address:</strong> ${client.address}</p>
            <p><strong>Service:</strong> ${client.service}</p>
            <p><strong>Reference Number:</strong> ${client.referenceNumber}</p>
            <p><strong>Referral Date:</strong> ${new Date(client.referralDate).toLocaleDateString()}</p>
            <p><strong>Date of Birth:</strong> ${new Date(client.dob).toLocaleDateString()}</p>
            <p><strong>Start Date:</strong> ${new Date(client.startDate).toLocaleDateString()}</p>
            <p><strong>Region:</strong> ${client.region}</p>
        `;
        popupOverlay.style.display = 'block';
    }

    // Close the popup when the close button is clicked
    document.querySelector('.popup-close').addEventListener('click', () => {
        document.querySelector('.popup-overlay').style.display = 'none';
    });

    // Close the popup when clicking outside of the popup content
    document.querySelector('.popup-overlay').addEventListener('click', (event) => {
        if (event.target === document.querySelector('.popup-overlay')) {
            document.querySelector('.popup-overlay').style.display = 'none';
        }
    });

</script>
</body>
</html>